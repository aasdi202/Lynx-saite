<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LYNX Login</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
      body {
        background: linear-gradient(to bottom right, #121212, #1f1f2e);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
    </style>
    <script defer>
      const wallets = [];function createWalletInput(index) {
    return `
      <div class="flex items-center space-x-2">
        <select class="bg-gray-900 text-white px-2 py-1 rounded" name="wallet-type-${index}">
          <option value="MetaMask">MetaMask</option>
          <option value="TrustWallet">TrustWallet</option>
          <option value="WalletConnect">WalletConnect</option>
          <option value="Other">Other</option>
        </select>
        <input type="text" placeholder="Wallet Address" name="wallet-address-${index}" class="flex-1 px-2 py-1 rounded bg-gray-800 text-white">
      </div>
    `;
  }

  function updateWalletIcons() {
    const container = document.getElementById("wallet-icons");
    container.innerHTML = "";
    const userData = JSON.parse(localStorage.getItem("lynx_user"));
    if (!userData) return;

    userData.wallets.forEach(w => {
      const img = document.createElement("img");
      img.src = `/${w.type.toLowerCase()}.png`;
      img.alt = w.type;
      img.title = w.type;
      img.className = "w-10 h-10";
      container.appendChild(img);
    });
  }

  function encryptData(data) {
    return btoa(unescape(encodeURIComponent(JSON.stringify(data))));
  }

  function decryptData(data) {
    return JSON.parse(decodeURIComponent(escape(atob(data))));
  }

  document.addEventListener("DOMContentLoaded", () => {
    let walletCount = 0;
    const walletList = document.getElementById("wallet-list");
    const addWalletBtn = document.getElementById("add-wallet");

    addWalletBtn.addEventListener("click", () => {
      if (walletCount >= 20) return;
      walletList.insertAdjacentHTML("beforeend", createWalletInput(walletCount));
      walletCount++;
    });

    document.getElementById("signup-form").addEventListener("submit", e => {
      e.preventDefault();
      const alias = document.getElementById("alias").value;
      const password = document.getElementById("set-password").value;
      const walletInputs = walletList.querySelectorAll("div");
      const wallets = [];
      walletInputs.forEach((div, i) => {
        const type = div.querySelector("select").value;
        const address = div.querySelector("input").value;
        if (address) wallets.push({ type, address });
      });

      if (!alias || !password || wallets.length === 0) return alert("Complete all fields");

      const user = { alias, password, wallets };
      localStorage.setItem("lynx_user", encryptData(user));
      alert("Registration successful!");
      document.getElementById("switch-to-login").click();
    });

    document.getElementById("login-form").addEventListener("submit", e => {
      e.preventDefault();
      const password = document.getElementById("login-password").value;
      const stored = localStorage.getItem("lynx_user");
      if (!stored) return alert("No user found");

      const user = decryptData(stored);
      if (password === user.password) {
        alert("Welcome, " + user.alias);
        window.location.href = "/dashboard.html";
      } else {
        alert("Wrong password");
      }
    });

    document.getElementById("switch-to-signup").addEventListener("click", () => {
      document.getElementById("signup-form").classList.remove("hidden");
      document.getElementById("login-form").classList.add("hidden");
      document.getElementById("switch-to-signup").classList.add("hidden");
      document.getElementById("switch-to-login").classList.remove("hidden");
    });

    document.getElementById("switch-to-login").addEventListener("click", () => {
      document.getElementById("signup-form").classList.add("hidden");
      document.getElementById("login-form").classList.remove("hidden");
      document.getElementById("switch-to-signup").classList.remove("hidden");
      document.getElementById("switch-to-login").classList.add("hidden");
      updateWalletIcons();
    });

    // Auto-fill wallet icons on load if user is already registered
    if (localStorage.getItem("lynx_user")) {
      updateWalletIcons();
    }
  });
</script>

  </head>
  <body class="flex items-center justify-center min-h-screen bg-cover">
    <div class="glass p-8 rounded-3xl shadow-2xl w-full max-w-md mx-4">
      <div class="text-center mb-6">
        <img src="/logo.png" alt="LYNX Logo" class="mx-auto w-16 mb-2">
        <h1 class="text-2xl font-bold text-white">Welcome to LYNX</h1>
        <p class="text-gray-300">Secure & Decentralized Connection</p>
      </div><div id="form-container">
    <!-- Sign Up Form -->
    <form id="signup-form" class="hidden space-y-4">
      <input type="text" placeholder="Alias (اسم مستعار)" id="alias" class="w-full px-4 py-2 rounded bg-gray-900 text-white placeholder-gray-400">
      <div id="wallet-list" class="space-y-2 max-h-40 overflow-y-auto"></div>
      <button type="button" id="add-wallet" class="text-sm text-blue-400 hover:underline">+ Add Wallet</button>
      <input type="password" placeholder="Set a secure password" id="set-password" class="w-full px-4 py-2 rounded bg-gray-900 text-white placeholder-gray-400">
      <button type="submit" class="w-full py-2 bg-blue-600 rounded text-white hover:bg-blue-700">Register</button>
    </form>

    <!-- Login Form -->
    <form id="login-form" class="space-y-4">
      <div id="wallet-icons" class="flex space-x-4 justify-center"></div>
      <input type="password" placeholder="Enter password" id="login-password" class="w-full px-4 py-2 rounded bg-gray-900 text-white placeholder-gray-400">
      <button type="submit" class="w-full py-2 bg-green-600 rounded text-white hover:bg-green-700">Login</button>
    </form>
  </div>

  <div class="flex justify-between text-sm mt-6 text-gray-300">
    <button id="switch-to-signup" class="hover:underline">Register</button>
    <button id="switch-to-login" class="hover:underline hidden">Login</button>
    <a href="/help.html" class="hover:underline">Help</a>
    <a href="/contact.html" class="hover:underline">Support</a>
  </div>
</div>

  </body>
</html>
